# 現在のタスク

## 引き継ぎ情報

### プロジェクト概要
- **BrainBusters**: Slay the Spire風のローグライクカードゲーム（React Native/Expo）
- 500の哲学概念カードを使ったターン制バトル
- 50階ダンジョン、10体のボス（5階ごと）

### 現在の状態
- バトルシステムは動作中
- 敵の攻撃は一体ずつ順次処理、メッセージはフェード表示
- 13カテゴリ別のカード効果テンプレート実装済み
- コンボシステム実装済み（14種のコンボ）
- バトルUI演出強化済み（フローティングエフェクト）
- 難易度調整完了（敵ダメージ2倍・HP1.5倍・調和強化）
- リスク/リターンカード実装済み（21枚: HPコスト4枚、条件付き4枚、ギャンブル13枚）
- 敵表示改善済み（160x120px、HPバー20px・テキスト内蔵）
- デバッグモード実装済み（開発時のみ表示）
- 報酬画面メッセージサイズ改善済み

### 重要ファイル
- `src/screens/BattleScreen.tsx` - バトル画面のメインロジック
- `src/screens/DebugScreen.tsx` - デバッグ画面（開発用）
- `src/data/cards.ts` - カード生成・効果テンプレート
- `src/types/game.ts` - ゲーム設定（GAME_CONFIG）
- `src/store/runStore.ts` - ゲーム状態管理

### 開発ツール
- **デバッグモード**: タイトル画面に「デバッグ」ボタン（開発モード時のみ表示）
  - バトルテスト: 任意の階層・敵数・敵タイプでバトル開始
  - 報酬画面テスト: 通常/ボス報酬をテスト
  - ゲーム設定確認: GAME_CONFIG値の確認
  - 敵情報表示: 各階層の敵種類数を確認

---

## 手動テスト（デバッグモード使用）

### バトルテスト
| # | シナリオ | 設定 | 確認ポイント |
|---|---------|------|-------------|
| 1 | 通常バトル基本 | 1階/敵1体/HP満タン/ストック0 | 基本動作確認 |
| 2 | 通常バトル敵3体 | 25階/敵3体/HP満タン/ストック0 | 敵3体の表示・ターゲット切替 |
| 3 | 高難度+ストック満杯 | 45階/敵3体/HP瀕死(10)/ストック5 | ストックカード使用・低HP警告 |
| 4 | エリート2体 | 20階/敵2体/HP半分(35)/ストック3 | エリート強さ・ストック使用 |
| 5 | 序盤ボス | 5階ボス(懐疑の淵)/HP満タン/ストック0 | ボス表示・行動パターン |
| 6 | 中盤ボス | 25階ボス(功利の天秤)/HP半分/ストック3 | ボス強さ・ストック戦略 |
| 7 | 最終ボス極限 | 50階ボス/HP瀕死(10)/ストック5 | 最高難度・全機能確認 |

### 報酬画面テスト
| # | シナリオ | 設定 | 確認ポイント |
|---|---------|------|-------------|
| 8 | ストック空→追加 | 通常報酬/ストック0 | カードをストックに追加できる |
| 9 | ストック一部→追加 | 通常報酬/ストック3 | 追加後のストック表示 |
| 10 | ストック満杯→入替 | 通常報酬/ストック5 | 入れ替えUI・警告メッセージ表示 |
| 11 | エリート報酬+満杯 | エリート報酬/ストック5 | 高レアカード・入れ替え動作 |
| 12 | ボス報酬+レリック | 5階ボス報酬/ストック0 | レリック表示・獲得 |
| 13 | ボス報酬複合 | 25階ボス報酬/ストック5 | レリック+カード入替 |
| 14 | 最終ボス報酬 | 50階ボス報酬 | 最終レリック確認 |

### UI表示テスト
| # | 確認内容 |
|---|---------|
| 15 | 敵3体の表示レイアウト（重なりなし・40pxオフセット） |
| 16 | ストック満杯警告メッセージの文字サイズ（16pt以上） |
| 17 | ボス名・HPバー・HP数値の視認性 |

### 操作フローテスト
| # | 確認内容 |
|---|---------|
| 18 | バトル「← 中断」→メニュー復帰 |
| 19 | バトル勝利→「報酬画面へ」→操作→メニュー復帰 |
| 20 | 報酬画面「← 中断」→メニュー復帰 |

---

## Phase 6: バトル演出 ← 次
- [ ] ダメージ演出の強化（50↑火花、100↑爆発+シェイク）
- [ ] 敵撃破時のエフェクト
- [ ] ボス戦勝利時の演出
- [ ] 報酬画面の演出

---

## Phase 7: コンテンツ拡充
- [ ] ショップ機能充実
- [ ] 図鑑機能
- [ ] レリック効果の確認・修正
- [ ] 設定画面の改善
- [ ] **最終ボス報酬の見直し**: 50階ボスのレリックは使う機会がないため別報酬に変更
  - 案1: ゴールド大量獲得
  - 案2: エンディング演出・実績解除
  - 案3: 特別なカードスキン解放

---

## Phase 8: 敵の哲学的テーマ化
- [ ] 敵キャラを哲学的テーマ化（「意識とは何か」「クオリア」など）
- [ ] カードの概念と関連付けてシナジーを作る

---

## Phase 9: 画像生成
- [ ] カード画像の生成（500枚）
- [ ] 敵キャラ画像の生成
- [ ] ボス画像の生成

---

## Phase 10: カードUI改善
- [ ] カード表示の大型化（画像表示対応）
- [ ] カルーセル型カード選択UI（3D回転式）

---

## 未来機能（Future Features）

### ステージ拡張
- [ ] 50階以上のステージ追加
- [ ] 新ボス追加（既存10体+α）
- [ ] 高難度エリア（敵の強化・新ギミック）

### 無限モード
- [ ] エンドレスモードの実装
  - ボス周回（5階ごとにボス、無限ループ）
  - 階層に応じた難易度スケーリング
  - ハイスコア記録
- [ ] デイリーチャレンジ（シード固定の日替わりラン）
